package com.hello.suripu.core.processors.insights;

import com.google.common.collect.ImmutableMap;

import java.util.HashMap;
import java.util.Map;

/**
 * Created by jingyun on 7/25/15.
 */
public class WakeVarianceData {
    // see https://s3.amazonaws.com/hello-data/insights-raw-data/blah?
    private static String DISTRIBUTION_DATA = "0,1.0\n" +
            "1,2.8\n" +
            "2,3.1\n" +
            "3,5.8\n" +
            "4,21.7\n" +
            "5,22.8\n" +
            "6,23.2\n" +
            "7,26.2\n" +
            "8,36.6\n" +
            "9,37.9\n" +
            "10,38.0\n" +
            "11,38.9\n" +
            "12,42.6\n" +
            "13,42.8\n" +
            "14,42.9\n" +
            "15,43.1\n" +
            "16,44.2\n" +
            "17,44.3\n" +
            "18,44.4\n" +
            "19,44.6\n" +
            "20,45.3\n" +
            "21,45.4\n" +
            "22,45.4\n" +
            "23,45.6\n" +
            "24,47.8\n" +
            "25,48.1\n" +
            "26,48.3\n" +
            "27,48.7\n" +
            "28,49.7\n" +
            "29,49.8\n" +
            "30,49.9\n" +
            "31,50.1\n" +
            "32,51.0\n" +
            "33,51.2\n" +
            "34,51.6\n" +
            "35,52.0\n" +
            "36,53.2\n" +
            "37,53.5\n" +
            "38,53.5\n" +
            "39,53.8\n" +
            "40,54.5\n" +
            "41,54.5\n" +
            "42,54.6\n" +
            "43,54.7\n" +
            "44,54.8\n" +
            "45,54.9\n" +
            "46,54.9\n" +
            "47,55.0\n" +
            "48,55.3\n" +
            "49,55.5\n" +
            "50,55.5\n" +
            "51,55.6\n" +
            "52,56.1\n" +
            "53,56.2\n" +
            "54,56.2\n" +
            "55,56.4\n" +
            "56,56.6\n" +
            "57,56.7\n" +
            "58,56.7\n" +
            "59,56.7\n" +
            "60,56.9\n" +
            "61,56.9\n" +
            "62,56.9\n" +
            "63,57.0\n" +
            "64,57.2\n" +
            "65,57.3\n" +
            "66,57.4\n" +
            "67,57.4\n" +
            "68,57.6\n" +
            "69,57.6\n" +
            "70,57.7\n" +
            "71,57.7\n" +
            "72,57.9\n" +
            "73,58.0\n" +
            "74,58.0\n" +
            "75,58.1\n" +
            "76,58.3\n" +
            "77,58.4\n" +
            "78,58.4\n" +
            "79,58.5\n" +
            "80,58.8\n" +
            "81,58.9\n" +
            "82,59.0\n" +
            "83,59.0\n" +
            "84,59.1\n" +
            "85,59.2\n" +
            "86,59.2\n" +
            "87,59.3\n" +
            "88,59.4\n" +
            "89,59.5\n" +
            "90,59.5\n" +
            "91,59.6\n" +
            "92,59.8\n" +
            "93,59.8\n" +
            "94,59.9\n" +
            "95,59.9\n" +
            "96,60.0\n" +
            "97,60.0\n" +
            "98,60.1\n" +
            "99,60.1\n" +
            "100,60.1\n" +
            "101,60.2\n" +
            "102,60.2\n" +
            "103,60.2\n" +
            "104,60.3\n" +
            "105,60.4\n" +
            "106,60.4\n" +
            "107,60.5\n" +
            "108,61.6\n" +
            "109,61.6\n" +
            "110,61.7\n" +
            "111,61.7\n" +
            "112,62.0\n" +
            "113,62.0\n" +
            "114,62.1\n" +
            "115,62.1\n" +
            "116,62.2\n" +
            "117,62.3\n" +
            "118,62.3\n" +
            "119,62.3\n" +
            "120,62.4\n" +
            "121,62.5\n" +
            "122,62.5\n" +
            "123,62.7\n" +
            "124,62.9\n" +
            "125,63.0\n" +
            "126,63.0\n" +
            "127,63.1\n" +
            "128,63.6\n" +
            "129,63.7\n" +
            "130,63.7\n" +
            "131,63.7\n" +
            "132,64.0\n" +
            "133,64.0\n" +
            "134,64.0\n" +
            "135,64.0\n" +
            "136,64.4\n" +
            "137,64.5\n" +
            "138,64.5\n" +
            "139,64.6\n" +
            "140,65.1\n" +
            "141,65.1\n" +
            "142,65.2\n" +
            "143,65.2\n" +
            "144,65.6\n" +
            "145,65.7\n" +
            "146,65.8\n" +
            "147,66.0\n" +
            "148,67.0\n" +
            "149,67.0\n" +
            "150,67.0\n" +
            "151,67.0\n" +
            "152,67.2\n" +
            "153,67.3\n" +
            "154,67.3\n" +
            "155,67.4\n" +
            "156,68.0\n" +
            "157,68.0\n" +
            "158,68.0\n" +
            "159,68.1\n" +
            "160,68.3\n" +
            "161,68.4\n" +
            "162,68.4\n" +
            "163,68.4\n" +
            "164,68.5\n" +
            "165,68.5\n" +
            "166,68.5\n" +
            "167,68.6\n" +
            "168,68.9\n" +
            "169,68.9\n" +
            "170,68.9\n" +
            "171,68.9\n" +
            "172,69.3\n" +
            "173,69.3\n" +
            "174,69.3\n" +
            "175,69.4\n" +
            "176,69.8\n" +
            "177,69.9\n" +
            "178,69.9\n" +
            "179,70.0\n" +
            "180,70.3\n" +
            "181,70.3\n" +
            "182,70.4\n" +
            "183,70.4\n" +
            "184,70.5\n" +
            "185,70.5\n" +
            "186,70.5\n" +
            "187,70.5\n" +
            "188,70.5\n" +
            "189,70.6\n" +
            "190,70.6\n" +
            "191,70.6\n" +
            "192,70.6\n" +
            "193,70.6\n" +
            "194,70.6\n" +
            "195,70.6\n" +
            "196,70.6\n" +
            "197,70.6\n" +
            "198,70.6\n" +
            "199,70.6\n" +
            "200,70.7\n" +
            "201,70.7\n" +
            "202,70.7\n" +
            "203,70.7\n" +
            "204,70.8\n" +
            "205,70.8\n" +
            "206,70.8\n" +
            "207,70.8\n" +
            "208,70.8\n" +
            "209,70.8\n" +
            "210,70.8\n" +
            "211,70.8\n" +
            "212,70.8\n" +
            "213,70.8\n" +
            "214,70.9\n" +
            "215,70.9\n" +
            "216,70.9\n" +
            "217,70.9\n" +
            "218,70.9\n" +
            "219,70.9\n" +
            "220,71.0\n" +
            "221,71.0\n" +
            "222,71.0\n" +
            "223,71.0\n" +
            "224,71.1\n" +
            "225,71.1\n" +
            "226,71.2\n" +
            "227,71.2\n" +
            "228,71.5\n" +
            "229,71.5\n" +
            "230,71.5\n" +
            "231,71.6\n" +
            "232,72.9\n" +
            "233,73.0\n" +
            "234,73.0\n" +
            "235,73.2\n" +
            "236,74.3\n" +
            "237,74.4\n" +
            "238,74.5\n" +
            "239,74.6\n" +
            "240,75.7\n" +
            "241,75.7\n" +
            "242,75.7\n" +
            "243,75.8\n" +
            "244,76.2\n" +
            "245,76.2\n" +
            "246,76.3\n" +
            "247,76.3\n" +
            "248,76.9\n" +
            "249,77.0\n" +
            "250,77.0\n" +
            "251,77.2\n" +
            "252,78.5\n" +
            "253,78.6\n" +
            "254,78.6\n" +
            "255,78.8\n" +
            "256,79.0\n" +
            "257,79.1\n" +
            "258,79.1\n" +
            "259,79.1\n" +
            "260,79.3\n" +
            "261,79.3\n" +
            "262,79.3\n" +
            "263,79.4\n" +
            "264,79.7\n" +
            "265,79.8\n" +
            "266,79.8\n" +
            "267,79.9\n" +
            "268,80.9\n" +
            "269,80.9\n" +
            "270,81.0\n" +
            "271,81.1\n" +
            "272,82.2\n" +
            "273,82.3\n" +
            "274,82.3\n" +
            "275,82.4\n" +
            "276,82.6\n" +
            "277,82.6\n" +
            "278,82.7\n" +
            "279,82.7\n" +
            "280,82.7\n" +
            "281,82.7\n" +
            "282,82.7\n" +
            "283,82.7\n" +
            "284,82.8\n" +
            "285,82.8\n" +
            "286,82.9\n" +
            "287,82.9\n" +
            "288,83.2\n" +
            "289,83.3\n" +
            "290,83.3\n" +
            "291,83.3\n" +
            "292,83.6\n" +
            "293,83.6\n" +
            "294,83.6\n" +
            "295,83.6\n" +
            "296,83.6\n" +
            "297,83.6\n" +
            "298,83.6\n" +
            "299,83.6\n" +
            "300,83.7\n" +
            "301,83.7\n" +
            "302,83.7\n" +
            "303,83.7\n" +
            "304,83.8\n" +
            "305,83.8\n" +
            "306,83.8\n" +
            "307,83.8\n" +
            "308,83.8\n" +
            "309,83.9\n" +
            "310,83.9\n" +
            "311,83.9\n" +
            "312,83.9\n" +
            "313,83.9\n" +
            "314,83.9\n" +
            "315,83.9\n" +
            "316,83.9\n" +
            "317,83.9\n" +
            "318,83.9\n" +
            "319,83.9\n" +
            "320,83.9\n" +
            "321,84.0\n" +
            "322,84.0\n" +
            "323,84.0\n" +
            "324,84.0\n" +
            "325,84.0\n" +
            "326,84.0\n" +
            "327,84.0\n" +
            "328,84.1\n" +
            "329,84.1\n" +
            "330,84.1\n" +
            "331,84.1\n" +
            "332,84.1\n" +
            "333,84.1\n" +
            "334,84.1\n" +
            "335,84.1\n" +
            "336,84.1\n" +
            "337,84.1\n" +
            "338,84.1\n" +
            "339,84.1\n" +
            "340,84.1\n" +
            "341,84.1\n" +
            "342,84.1\n" +
            "343,84.1\n" +
            "344,84.2\n" +
            "345,84.2\n" +
            "346,84.2\n" +
            "347,84.2\n" +
            "348,84.2\n" +
            "349,84.2\n" +
            "350,84.2\n" +
            "351,84.2\n" +
            "352,84.2\n" +
            "353,84.2\n" +
            "354,84.2\n" +
            "355,84.2\n" +
            "356,84.2\n" +
            "357,84.2\n" +
            "358,84.2\n" +
            "359,84.2\n" +
            "360,84.2\n" +
            "361,84.2\n" +
            "362,84.2\n" +
            "363,84.2\n" +
            "364,84.3\n" +
            "365,84.3\n" +
            "366,84.3\n" +
            "367,84.3\n" +
            "368,84.3\n" +
            "369,84.3\n" +
            "370,84.3\n" +
            "371,84.3\n" +
            "372,84.3\n" +
            "373,84.3\n" +
            "374,84.3\n" +
            "375,84.3\n" +
            "376,84.3\n" +
            "377,84.3\n" +
            "378,84.3\n" +
            "379,84.3\n" +
            "380,84.3\n" +
            "381,84.3\n" +
            "382,84.3\n" +
            "383,84.3\n" +
            "384,84.3\n" +
            "385,84.3\n" +
            "386,84.3\n" +
            "387,84.3\n" +
            "388,84.3\n" +
            "389,84.3\n" +
            "390,84.3\n" +
            "391,84.3\n" +
            "392,84.3\n" +
            "393,84.3\n" +
            "394,84.3\n" +
            "395,84.3\n" +
            "396,84.4\n" +
            "397,84.4\n" +
            "398,84.4\n" +
            "399,84.4\n" +
            "400,85.2";

    private static final double MAX_WAKE_VAR = 400;
    private static final int MAX_WAKE_VAR_PERCENTILE = 86;


    private ImmutableMap<Double, Integer> distributionLookup;


    public WakeVarianceData() {
        final Map<Double, Integer> temp = new HashMap<>();
        final String[] rows = DISTRIBUTION_DATA.split("\n");
        for(final String row : rows) {
            final String[] rowParts = row.split(",");
            final double wakeVariance = Float.parseFloat(rowParts[0]);
            final int percentile =  (int) Float.parseFloat(rowParts[1]);
            temp.put(wakeVariance, percentile);
        }
        this.distributionLookup = ImmutableMap.copyOf(temp);
    }


        public int getWakeVariancePercentile(final double wakeVarValue) {
        if (wakeVarValue > MAX_WAKE_VAR) {
                return MAX_WAKE_VAR_PERCENTILE;
        }
        return this.distributionLookup.get(wakeVarValue);
    }

}
